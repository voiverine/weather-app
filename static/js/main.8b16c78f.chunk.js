(this.webpackJsonpweatherapp=this.webpackJsonpweatherapp||[]).push([[0],{321:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(32),c=n.n(i),o=n(374),s=n(33),d=n(162),l=n(13),u=n(385),h=n(368),j=n(386),b=n(60),m=n(372),x=n(366),O=n(382),f=n(373),p="/2.5/weather",g="/2.5/forecast",v="/3.0/stations",y=n(21),w=n(18),S=n(19),C=n(165),T=n.n(C),M=new(function(){function e(t,n){Object(w.a)(this,e),this.baseURL=t,this.apiKey=n,this.axiosInstance=void 0,this.axiosInstance=T.a.create({baseURL:t}),this.axiosInstance.interceptors.request.use((function(e){return e.params=Object(y.a)(Object(y.a)({},e.params),{},{APPID:n,units:"metric"}),e}))}return Object(S.a)(e,[{key:"get",value:function(e,t){return this.axiosInstance({method:"GET",url:e,params:t}).then((function(e){return e.data})).catch((function(e){throw console.log(e),e}))}},{key:"post",value:function(e,t){return this.axiosInstance({method:"POST",url:e,data:t,headers:{"Content-Type":"application/json"}}).then((function(e){return e.data})).catch((function(e){throw console.log(e),e}))}},{key:"delete",value:function(e){return this.axiosInstance({method:"DELETE",url:e,headers:{"Content-Type":"application/json"}}).then((function(e){return e.data})).catch((function(e){throw console.log(e),e}))}}]),e}())("https://api.openweathermap.org/data","5a79fb7d70fa46e3dd11dcb26e9ad109"),L=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error";"string"===typeof e&&Object(b.b)(e,{type:t}),"object"===typeof e&&"message"in e&&Object(b.b)(null===e||void 0===e?void 0:e.message,{type:t}),e||Object(b.b)("Unidentified error")},F={showToast:!0,method:"GET"},I=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object(y.a)(Object(y.a)({},F),t),r=Object(s.useQuery)(e,(function(){return"DELETE"===t.method?M.delete(e[0]):M.get(e[0],e[1])}),n),i=r.error;return Object(a.useEffect)((function(){n.showToast&&i&&L(i)}),[i,n.toastMessage,n.showToast]),r},E=n(99),D=n.n(E),_=function(e){var t=1e3*e,n=D()();return{date:D()(t).format("ddd MMM DD YYYY, H:mm"),isToday:D()(t).isSame(n,"day")}},k=function(e){return"http://openweathermap.org/img/wn/"+e+"@2x.png"},A=function(){var e=Object(a.useState)(""),t=Object(l.a)(e,2),n=t[0],r=t[1],i=Object(a.useState)(p),c=Object(l.a)(i,2),o=c[0],s=c[1],d=I([p,{q:n}],{enabled:!1}),u=d.refetch,h=d.error,j=d.data,b=d.isLoading,m=I([g,{q:n}],{enabled:!1}),x=m.refetch,O=m.error,f=m.data,v=m.isLoading,w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o;e===p&&u(),e===g&&x()};return{handleSubmit:function(e){e.preventDefault(),n&&w()},handleForecastTypeChange:function(e,t){t&&s(t),t&&n&&w(t),!t&&n&&w()},error:h||O,isLoading:b||v,parsedData:Object(a.useMemo)((function(){return j&&o===p?(e=j,[Object(y.a)(Object(y.a)({type:p,id:e.dt,location:e.name},_(e.dt)),{},{icon:k(e.weather[0].icon),description:e.weather[0].description,clouds:e.weather[0].main,temp_min:Math.round(e.main.temp_min),temp_max:Math.round(e.main.temp_max)})]):f&&o===g?function(e){return e.list.map((function(t){return Object(y.a)(Object(y.a)({type:g,id:t.dt,location:e.city.name},_(t.dt)),{},{icon:k(t.weather[0].icon),description:t.weather[0].description,clouds:t.weather[0].main,temp_min:Math.round(t.main.temp_min),temp_max:Math.round(t.main.temp_max)})}))}(f):void 0;var e}),[j,f,o]),setSearchPhrase:r,searchPhrase:n,forecastType:o}},W=n(376),q=n(377),P=n(378),B=n(379),Q=n(380),Y=n(381),z=n(370),R=n(371),N=n(375),U=n(1),H={marginTop:6},X=function(e){var t=e.children;return Object(U.jsx)(N.a,{component:"h3",sx:H,children:t})},G=function(e){var t=e.data;if(0===t.length)return Object(U.jsx)(X,{children:"No forecast for that query."});var n=t[0].type===p?"Current weather":"5 day forecast";return Object(U.jsxs)(U.Fragment,{children:[Object(U.jsxs)(X,{children:[n," for ",t[0].location]}),Object(U.jsx)(W.a,{sx:{overflowX:"auto",width:"100%"},children:Object(U.jsxs)(q.a,{"aria-label":"simple table",children:[Object(U.jsx)(P.a,{children:Object(U.jsxs)(B.a,{children:[Object(U.jsx)(Q.a,{}),Object(U.jsx)(Q.a,{}),Object(U.jsx)(Q.a,{}),Object(U.jsx)(Q.a,{children:"High"}),Object(U.jsx)(Q.a,{children:"Low"})]})}),Object(U.jsx)(Y.a,{children:t.map((function(e){return Object(U.jsxs)(B.a,{children:[Object(U.jsxs)(Q.a,{component:"td",scope:"row",children:[e.date," ",e.isToday?Object(U.jsx)(z.a,{label:"Today"}):null]}),Object(U.jsx)(Q.a,{children:Object(U.jsx)(R.a,{sx:{width:"50px"},alt:e.description,title:e.description,src:e.icon})}),Object(U.jsx)(Q.a,{children:e.clouds}),Object(U.jsxs)(Q.a,{children:[e.temp_min," C"]}),Object(U.jsxs)(Q.a,{children:[e.temp_max," C"]})]},e.id)}))})]})})]})},J=function(){var e=A(),t=e.handleSubmit,n=e.handleForecastTypeChange,a=e.error,r=e.isLoading,i=e.parsedData,c=e.setSearchPhrase,o=e.searchPhrase,s=e.forecastType;return Object(U.jsxs)(m.a,{container:!0,spacing:1,sx:{alignItems:"center"},children:[Object(U.jsx)(m.a,{item:!0,xs:12,sm:4,children:Object(U.jsx)("form",{onSubmit:t,children:Object(U.jsx)(x.a,{fullWidth:!0,value:o,onChange:function(e){return c(e.target.value)},label:"search for city",variant:"outlined"})})}),Object(U.jsx)(m.a,{item:!0,xs:12,sm:8,children:Object(U.jsxs)(f.a,{color:"primary",value:s,exclusive:!0,onChange:n,children:[Object(U.jsx)(O.a,{value:p,children:"Current weather"}),Object(U.jsx)(O.a,{value:g,children:"5 day forecast"})]})}),a&&!i?Object(U.jsxs)(X,{children:["We couldn't fetch the results for ",o,"."]}):null,!i&&r?Object(U.jsx)(X,{children:"Loading..."}):null,i?Object(U.jsx)(G,{data:i}):null]})},K=n(384),V=n(115),Z=n.n(V),$=n(168),ee=n(16),te=n(174),ne=n(63),ae=ne.b({name:ne.c().required("Name is required"),latitude:ne.a().min(-90,"Must be higher than -90.").max(90,"Must be lower than 90.").required(),longitude:ne.a().min(-180,"Must be higher than -180.").max(180,"Must be lower than 180.").required(),altitude:ne.a().min(-100,"Must be higher than -100.").max(9e3,"Must be lower than 9000").required()}),re=n(97),ie=n(383),ce=function(e){var t=e.children,n=Object(re.a)(e,["children"]);return Object(U.jsx)(ie.a,Object(y.a)(Object(y.a)({size:"large"},n),{},{children:t}))},oe=function(){var e=function(){var e=Object(s.useQueryClient)(),t=Object(s.useMutation)((function(e){return M.post(v,e)}),{onError:function(e){L(e||"Couldn't add your station.")},onSuccess:function(t){L("Your station has been added.","success"),e.setQueryData([v],(function(e){var n=Object(y.a)(Object(y.a)({},t),{},{id:t.ID||t.id});return[].concat(Object(ee.a)(e||[]),[n])}))}}).mutateAsync,n=function(){var e=Object($.a)(Z.a.mark((function e(n,a){var r;return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(y.a)(Object(y.a)({},n),{},{external_id:"".concat(n.latitude,"_").concat(n.longitude,"_").concat(n.altitude)}),e.next=3,t(r);case 3:e.sent.ID&&a.resetForm();case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return{formik:Object(te.a)({initialValues:{name:"",latitude:"",longitude:"",altitude:""},validationSchema:ae,onSubmit:n})}}().formik;return Object(U.jsx)("div",{children:Object(U.jsxs)("form",{onSubmit:e.handleSubmit,children:[Object(U.jsxs)(m.a,{container:!0,spacing:1,sx:{alignItems:"center"},children:[Object(U.jsx)(m.a,{item:!0,xs:12,sm:3,children:Object(U.jsx)(x.a,{fullWidth:!0,id:"name",name:"name",label:"Name",value:e.values.name,onChange:e.handleChange,error:e.touched.name&&Boolean(e.errors.name),helperText:e.touched.name&&e.errors.name})}),Object(U.jsx)(m.a,{item:!0,xs:12,sm:3,children:Object(U.jsx)(x.a,{fullWidth:!0,id:"latitude",name:"latitude",label:"Latitude",type:"number",value:e.values.latitude,onChange:e.handleChange,error:e.touched.latitude&&Boolean(e.errors.latitude),helperText:e.touched.latitude&&e.errors.latitude})}),Object(U.jsx)(m.a,{item:!0,xs:12,sm:3,children:Object(U.jsx)(x.a,{fullWidth:!0,id:"longitude",name:"longitude",label:"Longitude",type:"number",value:e.values.longitude,onChange:e.handleChange,error:e.touched.longitude&&Boolean(e.errors.longitude),helperText:e.touched.longitude&&e.errors.longitude})})," ",Object(U.jsx)(m.a,{item:!0,xs:12,sm:3,children:Object(U.jsx)(x.a,{fullWidth:!0,id:"altitude",name:"altitude",label:"Altitude",type:"number",value:e.values.altitude,onChange:e.handleChange,error:e.touched.altitude&&Boolean(e.errors.altitude),helperText:e.touched.altitude&&e.errors.altitude})})]}),Object(U.jsx)(K.a,{sx:{display:"flex",justifyContent:"flex-end",paddingTop:2,paddingBottom:2},children:Object(U.jsx)(ce,{type:"submit",variant:"outlined",children:"Add"})})]})})},se=function(){var e=I([v]),t=e.isError,n=e.isLoading,r=e.data,i=function(){var e=Object(s.useQueryClient)(),t=Object(a.useRef)(new Set),n=function(e){t.current.has(e)?t.current.delete(e):t.current.add(e)};return{removeStation:Object(s.useMutation)((function(e){return n(e),M.delete("".concat(v,"/").concat(e))}),{onError:function(e,t){n(t),L(e||"Couldn't delete your station.")},onSuccess:function(t,a){L("Your station has been deleted.","success"),n(a),e.setQueryData([v],(function(e){return Array.isArray(e)?e.filter((function(e){return e.id!==a})):[]}))}}).mutate,disabled:t}}();return{isError:t,isLoading:n,data:r,removeStation:i.removeStation,disabled:i.disabled}},de=function(){var e=se(),t=e.isError,n=e.data,a=e.isLoading,r=e.removeStation,i=e.disabled;return Object(U.jsxs)("div",{children:[t?Object(U.jsx)(X,{children:"Couldn't fetch the station list."}):null,a&&!n?Object(U.jsx)(X,{children:"Loading..."}):null,n&&!n.length?Object(U.jsx)(X,{children:"Add a station."}):null,n&&n.length?Object(U.jsx)(U.Fragment,{children:Object(U.jsx)(W.a,{sx:{overflowX:"auto",width:"100%"},children:Object(U.jsxs)(q.a,{"aria-label":"simple table",children:[Object(U.jsx)(P.a,{children:Object(U.jsxs)(B.a,{children:[Object(U.jsx)(Q.a,{children:"Name"}),Object(U.jsx)(Q.a,{children:"Latitude"}),Object(U.jsx)(Q.a,{children:"Longitude"}),Object(U.jsx)(Q.a,{children:"Altitude"})]})}),Object(U.jsx)(Y.a,{children:n.map((function(e){return Object(U.jsxs)(B.a,{children:[Object(U.jsx)(Q.a,{component:"td",scope:"row",children:e.name}),Object(U.jsx)(Q.a,{children:e.latitude}),Object(U.jsx)(Q.a,{children:e.longitude}),Object(U.jsx)(Q.a,{children:e.altitude}),Object(U.jsx)(Q.a,{children:Object(U.jsx)(ie.a,{onClick:function(){r(e.id)},disabled:(t=e.id,i.current.has(t)),children:"X"})})]},e.id);var t}))})]})})}):null]})},le=function(){var e=function(){var e=Object(a.useState)(!1),t=Object(l.a)(e,2);return{isFormShown:t[0],setIsFormShown:t[1]}}(),t=e.isFormShown,n=e.setIsFormShown;return Object(U.jsxs)(K.a,{children:[t?Object(U.jsx)(oe,{}):null,Object(U.jsx)(ce,{variant:"outlined",onClick:function(){return n(!t)},children:t?"hide the form":"+Add a station"}),Object(U.jsx)(de,{})]})},ue=function(e){var t=e.children,n=e.value,a=e.index,r=Object(re.a)(e,["children","value","index"]);return Object(U.jsx)("div",Object(y.a)(Object(y.a)({role:"tabpanel",hidden:n!==a,id:a},r),{},{children:n===a&&Object(U.jsx)(K.a,{sx:{p:3},children:t})}))},he=(n(320),function(){var e=Object(a.useState)("stations"),t=Object(l.a)(e,2),n=t[0],r=t[1];return Object(U.jsxs)(u.a,{maxWidth:"lg",children:[Object(U.jsxs)("header",{children:[Object(U.jsxs)(h.a,{value:n,onChange:function(e,t){return r(t)},children:[Object(U.jsx)(j.a,{label:"Weather",id:"forecast",value:"forecast"}),Object(U.jsx)(j.a,{label:"My Weather Stations",id:"stations",value:"stations"})]}),Object(U.jsx)(ue,{value:n,index:"forecast",children:Object(U.jsx)(J,{})}),Object(U.jsx)(ue,{value:n,index:"stations",children:Object(U.jsx)(le,{})})]}),Object(U.jsx)(b.a,{position:"bottom-right"})]})}),je=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,387)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),a(e),r(e),i(e),c(e)}))},be=n(365),me=Object(be.a)({typography:{fontFamily:["-apple-system","BlinkMacSystemFont",'"Segoe UI"',"Roboto"].join(","),body1:{lineHeight:1.2},body2:{textAlign:"left"},h2:{fontSize:"1.2rem",fontWeight:500,textAlign:"left"},h3:{fontSize:"1.1rem",textAlign:"left",marginBottom:"0.2rem"}}}),xe=new s.QueryClient({defaultOptions:{queries:{retry:1}}}),Oe=n(364),fe=function(){return Object(U.jsx)(Oe.a,{styles:{html:{WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",height:"100%",width:"100%"},"*, *::before, *::after":{boxSizing:"inherit"},body:{height:"100%",width:"100%",margin:0,padding:0},"#root":{height:"100%",width:"100%"}}})};c.a.render(Object(U.jsx)(r.a.StrictMode,{children:Object(U.jsxs)(s.QueryClientProvider,{client:xe,children:[Object(U.jsxs)(o.a,{theme:me,children:[Object(U.jsx)(fe,{}),Object(U.jsx)(he,{})]}),Object(U.jsx)(d.ReactQueryDevtools,{initialIsOpen:!1})]})}),document.getElementById("root")),je()}},[[321,1,2]]]);
//# sourceMappingURL=main.8b16c78f.chunk.js.map