(this.webpackJsonpweatherapp=this.webpackJsonpweatherapp||[]).push([[0],{321:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(32),c=n.n(i),o=n(374),s=n(33),d=n(162),l=n(13),u=n(385),h=n(368),j=n(386),b=n(60),x=n(372),m=n(366),O=n(382),f=n(373),p="metric",g="/2.5/weather",v="/2.5/forecast",y="/3.0/stations",w=n(22),S=n(18),C=n(19),T=n(165),M=n.n(T),L=new(function(){function e(t){Object(S.a)(this,e),this.baseURL=t,this.axiosInstance=void 0,this.axiosInstance=M.a.create({baseURL:t})}return Object(C.a)(e,[{key:"get",value:function(e,t){return this.axiosInstance({method:"GET",url:e,params:t}).then((function(e){return e.data})).catch((function(e){throw console.log(e),e}))}},{key:"post",value:function(e,t){return this.axiosInstance({method:"POST",url:e,data:t,headers:{"Content-Type":"application/json"}}).then((function(e){return e.data})).catch((function(e){throw console.log(e),e}))}},{key:"delete",value:function(e){return this.axiosInstance({method:"DELETE",url:e,headers:{"Content-Type":"application/json"}}).then((function(e){return e.data})).catch((function(e){throw console.log(e),e}))}}]),e}())("https://weather-proxy-api.herokuapp.com/"),F=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error";"string"===typeof e&&Object(b.b)(e,{type:t}),"object"===typeof e&&"message"in e&&Object(b.b)(null===e||void 0===e?void 0:e.message,{type:t}),e||Object(b.b)("Unidentified error")},E={showToast:!0,method:"GET"},I=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object(w.a)(Object(w.a)({},E),t),r=Object(s.useQuery)(e,(function(){return"DELETE"===t.method?L.delete(e[0]):L.get(e[0],e[1])}),n),i=r.error;return Object(a.useEffect)((function(){n.showToast&&i&&F(i)}),[i,n.toastMessage,n.showToast]),r},k=n(99),D=n.n(k),_=function(e){var t=1e3*e,n=D()();return{date:D()(t).format("ddd MMM DD YYYY, H:mm"),isToday:D()(t).isSame(n,"day")}},A=function(e){return"http://openweathermap.org/img/wn/"+e+"@2x.png"},W=function(){var e=Object(a.useState)(""),t=Object(l.a)(e,2),n=t[0],r=t[1],i=Object(a.useState)(g),c=Object(l.a)(i,2),o=c[0],s=c[1],d=I([g,{q:n,units:p}],{enabled:!1}),u=d.refetch,h=d.error,j=d.data,b=d.isLoading,x=I([v,{q:n,units:p}],{enabled:!1}),m=x.refetch,O=x.error,f=x.data,y=x.isLoading,S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o;e===g&&u(),e===v&&m()};return{handleSubmit:function(e){e.preventDefault(),n&&S()},handleForecastTypeChange:function(e,t){t&&s(t),t&&n&&S(t),!t&&n&&S()},error:h||O,isLoading:b||y,parsedData:Object(a.useMemo)((function(){return j&&o===g?(e=j,[Object(w.a)(Object(w.a)({type:g,id:e.dt,location:e.name},_(e.dt)),{},{icon:A(e.weather[0].icon),description:e.weather[0].description,clouds:e.weather[0].main,temp_min:Math.round(e.main.temp_min),temp_max:Math.round(e.main.temp_max)})]):f&&o===v?function(e){return e.list.map((function(t){return Object(w.a)(Object(w.a)({type:v,id:t.dt,location:e.city.name},_(t.dt)),{},{icon:A(t.weather[0].icon),description:t.weather[0].description,clouds:t.weather[0].main,temp_min:Math.round(t.main.temp_min),temp_max:Math.round(t.main.temp_max)})}))}(f):void 0;var e}),[j,f,o]),setSearchPhrase:r,searchPhrase:n,forecastType:o}},q=n(376),B=n(377),P=n(378),Q=n(379),Y=n(380),z=n(381),R=n(370),N=n(371),U=n(375),H=n(1),X={marginTop:6},G=function(e){var t=e.children;return Object(H.jsx)(U.a,{component:"h3",sx:X,children:t})},J=function(e){var t=e.data;if(0===t.length)return Object(H.jsx)(G,{children:"No forecast for that query."});var n=t[0].type===g?"Current weather":"5 day forecast";return Object(H.jsxs)(H.Fragment,{children:[Object(H.jsxs)(G,{children:[n," for ",t[0].location]}),Object(H.jsx)(q.a,{sx:{overflowX:"auto",width:"100%"},children:Object(H.jsxs)(B.a,{"aria-label":"simple table",children:[Object(H.jsx)(P.a,{children:Object(H.jsxs)(Q.a,{children:[Object(H.jsx)(Y.a,{}),Object(H.jsx)(Y.a,{}),Object(H.jsx)(Y.a,{}),Object(H.jsx)(Y.a,{children:"High"}),Object(H.jsx)(Y.a,{children:"Low"})]})}),Object(H.jsx)(z.a,{children:t.map((function(e){return Object(H.jsxs)(Q.a,{children:[Object(H.jsxs)(Y.a,{component:"td",scope:"row",children:[e.date," ",e.isToday?Object(H.jsx)(R.a,{label:"Today"}):null]}),Object(H.jsx)(Y.a,{children:Object(H.jsx)(N.a,{sx:{width:"50px"},alt:e.description,title:e.description,src:e.icon})}),Object(H.jsx)(Y.a,{children:e.clouds}),Object(H.jsxs)(Y.a,{children:[e.temp_min," C"]}),Object(H.jsxs)(Y.a,{children:[e.temp_max," C"]})]},e.id)}))})]})})]})},V=function(){var e=W(),t=e.handleSubmit,n=e.handleForecastTypeChange,a=e.error,r=e.isLoading,i=e.parsedData,c=e.setSearchPhrase,o=e.searchPhrase,s=e.forecastType;return Object(H.jsxs)(x.a,{container:!0,spacing:1,sx:{alignItems:"center"},children:[Object(H.jsx)(x.a,{item:!0,xs:12,sm:4,children:Object(H.jsx)("form",{onSubmit:t,children:Object(H.jsx)(m.a,{fullWidth:!0,value:o,onChange:function(e){return c(e.target.value)},label:"search for city",variant:"outlined"})})}),Object(H.jsx)(x.a,{item:!0,xs:12,sm:8,children:Object(H.jsxs)(f.a,{color:"primary",value:s,exclusive:!0,onChange:n,children:[Object(H.jsx)(O.a,{value:g,children:"Current weather"}),Object(H.jsx)(O.a,{value:v,children:"5 day forecast"})]})}),a&&!i?Object(H.jsxs)(G,{children:["We couldn't fetch the results for ",o,"."]}):null,!i&&r?Object(H.jsx)(G,{children:"Loading..."}):null,i?Object(H.jsx)(J,{data:i}):null]})},K=n(384),Z=n(115),$=n.n(Z),ee=n(168),te=n(16),ne=n(174),ae=n(63),re=ae.b({name:ae.c().required("Name is required"),latitude:ae.a().min(-90,"Must be higher than -90.").max(90,"Must be lower than 90.").required(),longitude:ae.a().min(-180,"Must be higher than -180.").max(180,"Must be lower than 180.").required(),altitude:ae.a().min(-100,"Must be higher than -100.").max(9e3,"Must be lower than 9000").required()}),ie=n(97),ce=n(383),oe=function(e){var t=e.children,n=Object(ie.a)(e,["children"]);return Object(H.jsx)(ce.a,Object(w.a)(Object(w.a)({size:"large"},n),{},{children:t}))},se=function(){var e=function(){var e=Object(s.useQueryClient)(),t=Object(s.useMutation)((function(e){return L.post(y,e)}),{onError:function(e){F(e||"Couldn't add your station.")},onSuccess:function(t){F("Your station has been added.","success"),e.setQueryData([y],(function(e){var n=Object(w.a)(Object(w.a)({},t),{},{id:t.ID||t.id});return[].concat(Object(te.a)(e||[]),[n])}))}}).mutateAsync,n=function(){var e=Object(ee.a)($.a.mark((function e(n,a){var r;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(w.a)(Object(w.a)({},n),{},{external_id:"".concat(n.latitude,"_").concat(n.longitude,"_").concat(n.altitude)}),e.next=3,t(r);case 3:e.sent.ID&&a.resetForm();case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return{formik:Object(ne.a)({initialValues:{name:"",latitude:"",longitude:"",altitude:""},validationSchema:re,onSubmit:n})}}().formik;return Object(H.jsx)("div",{children:Object(H.jsxs)("form",{onSubmit:e.handleSubmit,children:[Object(H.jsxs)(x.a,{container:!0,spacing:1,sx:{alignItems:"center"},children:[Object(H.jsx)(x.a,{item:!0,xs:12,sm:3,children:Object(H.jsx)(m.a,{fullWidth:!0,id:"name",name:"name",label:"Name",value:e.values.name,onChange:e.handleChange,error:e.touched.name&&Boolean(e.errors.name),helperText:e.touched.name&&e.errors.name})}),Object(H.jsx)(x.a,{item:!0,xs:12,sm:3,children:Object(H.jsx)(m.a,{fullWidth:!0,id:"latitude",name:"latitude",label:"Latitude",type:"number",value:e.values.latitude,onChange:e.handleChange,error:e.touched.latitude&&Boolean(e.errors.latitude),helperText:e.touched.latitude&&e.errors.latitude})}),Object(H.jsx)(x.a,{item:!0,xs:12,sm:3,children:Object(H.jsx)(m.a,{fullWidth:!0,id:"longitude",name:"longitude",label:"Longitude",type:"number",value:e.values.longitude,onChange:e.handleChange,error:e.touched.longitude&&Boolean(e.errors.longitude),helperText:e.touched.longitude&&e.errors.longitude})})," ",Object(H.jsx)(x.a,{item:!0,xs:12,sm:3,children:Object(H.jsx)(m.a,{fullWidth:!0,id:"altitude",name:"altitude",label:"Altitude",type:"number",value:e.values.altitude,onChange:e.handleChange,error:e.touched.altitude&&Boolean(e.errors.altitude),helperText:e.touched.altitude&&e.errors.altitude})})]}),Object(H.jsx)(K.a,{sx:{display:"flex",justifyContent:"flex-end",paddingTop:2,paddingBottom:2},children:Object(H.jsx)(oe,{type:"submit",variant:"outlined",children:"Add"})})]})})},de=function(){var e=I([y]),t=e.isError,n=e.isLoading,r=e.data,i=function(){var e=Object(s.useQueryClient)(),t=Object(a.useRef)(new Set),n=function(e){t.current.has(e)?t.current.delete(e):t.current.add(e)};return{removeStation:Object(s.useMutation)((function(e){return n(e),L.delete("".concat(y,"/").concat(e))}),{onError:function(e,t){n(t),F(e||"Couldn't delete your station.")},onSuccess:function(t,a){F("Your station has been deleted.","success"),n(a),e.setQueryData([y],(function(e){return Array.isArray(e)?e.filter((function(e){return e.id!==a})):[]}))}}).mutate,disabled:t}}();return{isError:t,isLoading:n,data:r,removeStation:i.removeStation,disabled:i.disabled}},le=function(){var e=de(),t=e.isError,n=e.data,a=e.isLoading,r=e.removeStation,i=e.disabled;return Object(H.jsxs)("div",{children:[t?Object(H.jsx)(G,{children:"Couldn't fetch the station list."}):null,a&&!n?Object(H.jsx)(G,{children:"Loading..."}):null,n&&!n.length?Object(H.jsx)(G,{children:"Add a station."}):null,n&&n.length?Object(H.jsx)(H.Fragment,{children:Object(H.jsx)(q.a,{sx:{overflowX:"auto",width:"100%"},children:Object(H.jsxs)(B.a,{"aria-label":"simple table",children:[Object(H.jsx)(P.a,{children:Object(H.jsxs)(Q.a,{children:[Object(H.jsx)(Y.a,{children:"Name"}),Object(H.jsx)(Y.a,{children:"Latitude"}),Object(H.jsx)(Y.a,{children:"Longitude"}),Object(H.jsx)(Y.a,{children:"Altitude"})]})}),Object(H.jsx)(z.a,{children:n.map((function(e){return Object(H.jsxs)(Q.a,{children:[Object(H.jsx)(Y.a,{component:"td",scope:"row",children:e.name}),Object(H.jsx)(Y.a,{children:e.latitude}),Object(H.jsx)(Y.a,{children:e.longitude}),Object(H.jsx)(Y.a,{children:e.altitude}),Object(H.jsx)(Y.a,{children:Object(H.jsx)(ce.a,{onClick:function(){r(e.id)},disabled:(t=e.id,i.current.has(t)),children:"X"})})]},e.id);var t}))})]})})}):null]})},ue=function(){var e=function(){var e=Object(a.useState)(!1),t=Object(l.a)(e,2);return{isFormShown:t[0],setIsFormShown:t[1]}}(),t=e.isFormShown,n=e.setIsFormShown;return Object(H.jsxs)(K.a,{children:[t?Object(H.jsx)(se,{}):null,Object(H.jsx)(oe,{variant:"outlined",onClick:function(){return n(!t)},children:t?"hide the form":"+Add a station"}),Object(H.jsx)(le,{})]})},he=function(e){var t=e.children,n=e.value,a=e.index,r=Object(ie.a)(e,["children","value","index"]);return Object(H.jsx)("div",Object(w.a)(Object(w.a)({role:"tabpanel",hidden:n!==a,id:a},r),{},{children:n===a&&Object(H.jsx)(K.a,{sx:{p:3},children:t})}))},je=(n(320),function(){var e=Object(a.useState)("forecast"),t=Object(l.a)(e,2),n=t[0],r=t[1];return Object(H.jsxs)(u.a,{maxWidth:"lg",children:[Object(H.jsxs)("header",{children:[Object(H.jsxs)(h.a,{value:n,onChange:function(e,t){return r(t)},children:[Object(H.jsx)(j.a,{label:"Weather",id:"forecast",value:"forecast"}),Object(H.jsx)(j.a,{label:"My Weather Stations",id:"stations",value:"stations"})]}),Object(H.jsx)(he,{value:n,index:"forecast",children:Object(H.jsx)(V,{})}),Object(H.jsx)(he,{value:n,index:"stations",children:Object(H.jsx)(ue,{})})]}),Object(H.jsx)(b.a,{position:"bottom-right"})]})}),be=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,387)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),a(e),r(e),i(e),c(e)}))},xe=n(365),me=Object(xe.a)({typography:{fontFamily:["-apple-system","BlinkMacSystemFont",'"Segoe UI"',"Roboto"].join(","),body1:{lineHeight:1.2},body2:{textAlign:"left"},h2:{fontSize:"1.2rem",fontWeight:500,textAlign:"left"},h3:{fontSize:"1.1rem",textAlign:"left",marginBottom:"0.2rem"}}}),Oe=new s.QueryClient({defaultOptions:{queries:{retry:1}}}),fe=n(364),pe=function(){return Object(H.jsx)(fe.a,{styles:{html:{WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",height:"100%",width:"100%"},"*, *::before, *::after":{boxSizing:"inherit"},body:{height:"100%",width:"100%",margin:0,padding:0},"#root":{height:"100%",width:"100%"}}})};c.a.render(Object(H.jsx)(r.a.StrictMode,{children:Object(H.jsxs)(s.QueryClientProvider,{client:Oe,children:[Object(H.jsxs)(o.a,{theme:me,children:[Object(H.jsx)(pe,{}),Object(H.jsx)(je,{})]}),Object(H.jsx)(d.ReactQueryDevtools,{initialIsOpen:!1})]})}),document.getElementById("root")),be()}},[[321,1,2]]]);
//# sourceMappingURL=main.cd877b93.chunk.js.map